<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>http基础 | 码农机器人</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="努力向前">
    
    <link rel="preload" href="/assets/css/0.styles.702c69be.css" as="style"><link rel="preload" href="/assets/js/app.1b1ef615.js" as="script"><link rel="preload" href="/assets/js/2.b3eacf93.js" as="script"><link rel="preload" href="/assets/js/35.486c6720.js" as="script"><link rel="prefetch" href="/assets/js/10.8ae3b0fa.js"><link rel="prefetch" href="/assets/js/100.8e461e21.js"><link rel="prefetch" href="/assets/js/101.c9aa29d8.js"><link rel="prefetch" href="/assets/js/102.d59ac7d5.js"><link rel="prefetch" href="/assets/js/103.06601afd.js"><link rel="prefetch" href="/assets/js/104.3126153a.js"><link rel="prefetch" href="/assets/js/105.787b4a9e.js"><link rel="prefetch" href="/assets/js/106.a13b5646.js"><link rel="prefetch" href="/assets/js/107.772d17d1.js"><link rel="prefetch" href="/assets/js/108.672d9d52.js"><link rel="prefetch" href="/assets/js/109.3b8bd873.js"><link rel="prefetch" href="/assets/js/11.5045f9e2.js"><link rel="prefetch" href="/assets/js/110.f7cd8143.js"><link rel="prefetch" href="/assets/js/111.11a1bb1b.js"><link rel="prefetch" href="/assets/js/112.f69d991a.js"><link rel="prefetch" href="/assets/js/113.b7b48dc4.js"><link rel="prefetch" href="/assets/js/114.7296808e.js"><link rel="prefetch" href="/assets/js/115.6b7a66a6.js"><link rel="prefetch" href="/assets/js/116.dcf2b4c3.js"><link rel="prefetch" href="/assets/js/117.3c45af7d.js"><link rel="prefetch" href="/assets/js/12.ca057691.js"><link rel="prefetch" href="/assets/js/13.3004493b.js"><link rel="prefetch" href="/assets/js/14.3bea3387.js"><link rel="prefetch" href="/assets/js/15.a597c712.js"><link rel="prefetch" href="/assets/js/16.d6071957.js"><link rel="prefetch" href="/assets/js/17.353ee1e9.js"><link rel="prefetch" href="/assets/js/18.61b9b46d.js"><link rel="prefetch" href="/assets/js/19.27409e91.js"><link rel="prefetch" href="/assets/js/20.439a8dbf.js"><link rel="prefetch" href="/assets/js/21.fb8699b6.js"><link rel="prefetch" href="/assets/js/22.f46c60a8.js"><link rel="prefetch" href="/assets/js/23.f904b39c.js"><link rel="prefetch" href="/assets/js/24.3d1ee2c1.js"><link rel="prefetch" href="/assets/js/25.7d4ed5a0.js"><link rel="prefetch" href="/assets/js/26.d571d0bf.js"><link rel="prefetch" href="/assets/js/27.1d4bb701.js"><link rel="prefetch" href="/assets/js/28.007df186.js"><link rel="prefetch" href="/assets/js/29.d88424e0.js"><link rel="prefetch" href="/assets/js/3.3db0febc.js"><link rel="prefetch" href="/assets/js/30.a37fd833.js"><link rel="prefetch" href="/assets/js/31.7ecc7963.js"><link rel="prefetch" href="/assets/js/32.409ba384.js"><link rel="prefetch" href="/assets/js/33.d039d1c8.js"><link rel="prefetch" href="/assets/js/34.5859246d.js"><link rel="prefetch" href="/assets/js/36.a7a17303.js"><link rel="prefetch" href="/assets/js/37.abb9cfe7.js"><link rel="prefetch" href="/assets/js/38.fad0d56f.js"><link rel="prefetch" href="/assets/js/39.c48f04f6.js"><link rel="prefetch" href="/assets/js/4.9d11c90d.js"><link rel="prefetch" href="/assets/js/40.8183bf66.js"><link rel="prefetch" href="/assets/js/41.2d4d1b88.js"><link rel="prefetch" href="/assets/js/42.7e3d30f8.js"><link rel="prefetch" href="/assets/js/43.1ac56ea1.js"><link rel="prefetch" href="/assets/js/44.ea97f2e2.js"><link rel="prefetch" href="/assets/js/45.6978a358.js"><link rel="prefetch" href="/assets/js/46.9833c297.js"><link rel="prefetch" href="/assets/js/47.ce84d094.js"><link rel="prefetch" href="/assets/js/48.1359e176.js"><link rel="prefetch" href="/assets/js/49.401bc027.js"><link rel="prefetch" href="/assets/js/5.4567470c.js"><link rel="prefetch" href="/assets/js/50.5e7b9608.js"><link rel="prefetch" href="/assets/js/51.2cdc4494.js"><link rel="prefetch" href="/assets/js/52.1dfaaa61.js"><link rel="prefetch" href="/assets/js/53.afe42f3f.js"><link rel="prefetch" href="/assets/js/54.36790444.js"><link rel="prefetch" href="/assets/js/55.a76d6ef9.js"><link rel="prefetch" href="/assets/js/56.bd7c7358.js"><link rel="prefetch" href="/assets/js/57.28181d38.js"><link rel="prefetch" href="/assets/js/58.df8e67c4.js"><link rel="prefetch" href="/assets/js/59.b23cd127.js"><link rel="prefetch" href="/assets/js/6.587cc912.js"><link rel="prefetch" href="/assets/js/60.bd3576fc.js"><link rel="prefetch" href="/assets/js/61.e28fcd11.js"><link rel="prefetch" href="/assets/js/62.1092f591.js"><link rel="prefetch" href="/assets/js/63.faa72537.js"><link rel="prefetch" href="/assets/js/64.fcae0e7b.js"><link rel="prefetch" href="/assets/js/65.e1bc1a19.js"><link rel="prefetch" href="/assets/js/66.0d4c9ad8.js"><link rel="prefetch" href="/assets/js/67.61777955.js"><link rel="prefetch" href="/assets/js/68.b1cc7e65.js"><link rel="prefetch" href="/assets/js/69.71b4cc97.js"><link rel="prefetch" href="/assets/js/7.98745309.js"><link rel="prefetch" href="/assets/js/70.516ad7cf.js"><link rel="prefetch" href="/assets/js/71.74ccefea.js"><link rel="prefetch" href="/assets/js/72.d9b6a696.js"><link rel="prefetch" href="/assets/js/73.f29d17c7.js"><link rel="prefetch" href="/assets/js/74.838b704c.js"><link rel="prefetch" href="/assets/js/75.c54b575e.js"><link rel="prefetch" href="/assets/js/76.c934d39f.js"><link rel="prefetch" href="/assets/js/77.5b97e6cd.js"><link rel="prefetch" href="/assets/js/78.dd29460e.js"><link rel="prefetch" href="/assets/js/79.b94a5658.js"><link rel="prefetch" href="/assets/js/8.fdead6cf.js"><link rel="prefetch" href="/assets/js/80.cdbdb467.js"><link rel="prefetch" href="/assets/js/81.c0c76140.js"><link rel="prefetch" href="/assets/js/82.efa9115c.js"><link rel="prefetch" href="/assets/js/83.c596b7f1.js"><link rel="prefetch" href="/assets/js/84.339bed5b.js"><link rel="prefetch" href="/assets/js/85.069eda30.js"><link rel="prefetch" href="/assets/js/86.10bdc89e.js"><link rel="prefetch" href="/assets/js/87.553ea18c.js"><link rel="prefetch" href="/assets/js/88.392cad61.js"><link rel="prefetch" href="/assets/js/89.45cd707b.js"><link rel="prefetch" href="/assets/js/9.1240f817.js"><link rel="prefetch" href="/assets/js/90.7b4883f8.js"><link rel="prefetch" href="/assets/js/91.d2045219.js"><link rel="prefetch" href="/assets/js/92.e14c966d.js"><link rel="prefetch" href="/assets/js/93.29606dd7.js"><link rel="prefetch" href="/assets/js/94.4c2a819c.js"><link rel="prefetch" href="/assets/js/95.ba79d75a.js"><link rel="prefetch" href="/assets/js/96.ad88c783.js"><link rel="prefetch" href="/assets/js/97.641137f2.js"><link rel="prefetch" href="/assets/js/98.eae84405.js"><link rel="prefetch" href="/assets/js/99.732a6c3c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.702c69be.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="码农机器人" class="logo"> <span class="site-name can-hide">码农机器人</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/react/" class="nav-link">
  react
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/react/" class="nav-link">
  react
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>建立前端知识体系</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue源码分析</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>提效赋能 前端工程化篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>程序员PLUS篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>HTTP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/http/HTTP协议.html" class="sidebar-link">HTTP简介</a></li><li><a href="/note/http/HTTP缓存.html" class="sidebar-link">HTTP缓存</a></li><li><a href="/note/http/DNS.html" class="sidebar-link">DNS</a></li><li><a href="/note/http/TCP-IP.html" class="sidebar-link">TCP/IP</a></li><li><a href="/note/http/http基础.html" class="active sidebar-link">http基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/http/http基础.html#浏览器输入url按回车背后经历了哪些" class="sidebar-link">浏览器输入url按回车背后经历了哪些?</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#get和post的区别" class="sidebar-link">GET和POST的区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/http/http基础.html#localstorage-与-sessionstorage-与cookie的区别总结" class="sidebar-link">localStorage 与 sessionStorage 与cookie的区别总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#http状态码" class="sidebar-link">HTTP状态码</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#http和https区别" class="sidebar-link">http和https区别？</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#什么是http协议无状态协议-怎么解决http协议无状态协议" class="sidebar-link">什么是Http协议无状态协议?怎么解决Http协议无状态协议?</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#三次握手和四次挥手" class="sidebar-link">三次握手和四次挥手</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#为什么连接的时候是三次握手-关闭的时候却是四次握手" class="sidebar-link">为什么连接的时候是三次握手，关闭的时候却是四次握手？</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#为什么time-wait状态需要经过2msl-最大报文段生存时间-才能返回到close状态" class="sidebar-link">为什么TIME_WAIT状态需要经过2MSL(最大报文段生存时间)才能返回到CLOSE状态？</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#为什么不能用两次握手进行连接" class="sidebar-link">为什么不能用两次握手进行连接？</a></li><li class="sidebar-sub-header"><a href="/note/http/http基础.html#如果已经建立了连接-但是客户端突然出现故障了怎么办" class="sidebar-link">如果已经建立了连接，但是客户端突然出现故障了怎么办？</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>忍者秘籍书</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http基础"><a href="#http基础" class="header-anchor">#</a> http基础</h1> <h2 id="浏览器输入url按回车背后经历了哪些"><a href="#浏览器输入url按回车背后经历了哪些" class="header-anchor">#</a> 浏览器输入url按回车背后经历了哪些?</h2> <ul><li>在浏览器地址栏输入url，先解析ulr，检测url地址是否合法</li> <li>浏览器先查看浏览器缓存-系统缓存-路由器缓存，如果缓存中有，会直接在屏幕中显示页面内容。若没有，则跳到第三步操作。
<ul><li>浏览器缓存:浏览器会记录DNS一段时间，因此，只是第一个地方解析DNS请求；</li> <li>操作系统缓存:如果在浏览器缓存中不包含这个记录，则会使系统调用操作系统，获取操作系统的记录(保存最近的DNS查询缓存)；</li> <li>路由器缓存:如果上述两个步骤均不能成功获取DNS记录，继续搜索路由器缓存</li> <li>ISP缓存:若上述均失败，继续向ISP搜索。</li></ul></li> <li>在发送http请求前，需要域名解析(DNS解析)，解析获取响应的IP地址</li> <li>浏览器向服务器发送tcp链接，与浏览器简历tcp三次握手。</li> <li>握手成功后，浏览器向服务器发送http请求，请求数据包。</li> <li>服务器处理收到的请求，将数据返回至浏览器。</li> <li>浏览器收到http响应。</li> <li>浏览器解码响应，如果响应可以缓存，则存入缓存。</li> <li>浏览器发送请求获取嵌入在HTML中的资源(html，css，JavaScript，图片，音乐......)。</li> <li>浏览器发送异步请求。</li> <li>页面全部渲染结束。</li></ul> <h2 id="get和post的区别"><a href="#get和post的区别" class="header-anchor">#</a> GET和POST的区别</h2> <ul><li>GET产生的URL地址可以被Bookmark，而POST不可以。</li> <li>GET请求会被浏览器主动cache，而POST不会，除非手动设置。</li> <li>GET请求只能进行url编码，而POST支持多种编码方式。</li> <li>GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。</li> <li>GET请求在URL中传送的参数是有长度限制的，而POST么有。</li> <li>对参数的数据类型，GET只接受ASCII字符，而POST没有限制。</li> <li>GET比POST更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。</li> <li>GET参数通过URL传递，POST放在Request body中。</li></ul> <p>GET和POST有一个重大区别，简单的说：</p> <p><strong>GET产生一个TCP数据包；POST产生两个TCP数据包。</strong></p> <p>长的说：</p> <p><strong>对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）；
而对于POST，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据）。</strong></p> <h3 id="localstorage-与-sessionstorage-与cookie的区别总结"><a href="#localstorage-与-sessionstorage-与cookie的区别总结" class="header-anchor">#</a> localStorage 与 sessionStorage 与cookie的区别总结</h3> <ul><li><p><strong>共同点</strong>: 都保存在浏览器端, 且同源</p></li> <li><p><strong>在同一浏览器下生命周期不同</strong></p> <p>Cookie生命周期: 默认是关闭浏览器后失效, 但是也可以设置过期时间</p> <p>SessionStorage生命周期: 仅在当前会话(窗口)下有效，关闭窗口或浏览器后被清除, 不能设置过期时间</p> <p>LocalStorage生命周期:除非被清除，否则永久保存</p></li> <li><p><strong>容量不同</strong></p> <p>Cookie容量限制: 大小(4KB左右)和个数(20~50)</p> <p>SessionStorage和LocalStorage容量限制: 大小(5M左右)</p></li> <li><p><strong>网络请求不同</strong></p> <p>Cookie网络请求:每次都会携带在HTTP请求头中，如果使用cookie保存过多数据会带来性能问题</p> <p>SessionStorage和LocalStorage网络请求: 仅在浏览器中保存，不参与和服务器的通信</p></li></ul> <h2 id="http状态码"><a href="#http状态码" class="header-anchor">#</a> HTTP状态码</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">200</span> 请求已成功，请求所希望的响应头或数据体将随此响应返回。
<span class="token number">201</span> 请求已经被实现，而且有一个新的资源已经依据请求的需要而建立，且其 <span class="token constant">URI</span> 已经随Location 头信息返回
<span class="token number">202</span> 服务器已接受请求，但尚未处理
<span class="token number">301</span> （永久移动） 请求的网页已永久移动到新位置。 服务器返回此响应（对 <span class="token constant">GET</span> 或 <span class="token constant">HEAD</span> 请求的响应）时，会自动将请求者转到新位置。
<span class="token number">302</span> （临时移动） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。
<span class="token number">303</span> （查看其他位置） 请求者应当对不同的位置使用单独的 <span class="token constant">GET</span> 请求来检索响应时，服务器返回此代码。
<span class="token number">304</span> （未修改） 自从上次请求后，请求的网页未修改过。 服务器返回此响应时，不会返回网页内容。
<span class="token number">305</span> （使用代理） 请求者只能使用代理访问请求的网页。 如果服务器返回此响应，还表示请求者应使用代理。
<span class="token number">307</span> （临时重定向） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。
<span class="token number">401</span> 当前请求需要用户验证。如果当前请求已经包含了 Authorization 证书，那么<span class="token number">401</span>响应代表着服务器验证已经拒绝了那些证书
<span class="token number">403</span> 服务器已经理解请求，但是拒绝执行它。与<span class="token number">401</span>响应不同的是，身份验证并不能提供任何帮助，而且这个请求也不应该被重复提交
<span class="token number">404</span> 请求失败，请求所希望得到的资源未被在服务器上发现
<span class="token number">500</span> 服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。一般来说，这个问题都会在服务器的程序码出错时出现。
<span class="token number">501</span> 服务器不支持当前请求所需要的某个功能。当服务器无法识别请求的方法，并且无法支持其对任何资源的请求。
<span class="token number">502</span> 作为网关或者代理工作的服务器尝试执行请求时，从上游服务器接收到无效的响应。
<span class="token number">503</span> 由于临时的服务器维护或者过载，服务器当前无法处理请求。这个状况是临时的，并且将在一段时间以后恢复。
</code></pre></div><h2 id="http和https区别"><a href="#http和https区别" class="header-anchor">#</a> http和https区别？</h2> <p>HTTP协议传输的数据都是未加密的，也就是明文的，因此使用HTTP协议传输隐私信息非常不安全，为了保证这些隐私数据能加密传输，于是王景公司设计了SSL协议用于对HTTP协议传输的数据进行加密，从而就诞生了HTTPS。简单的说，HTTPS协议是由SSL+HTTP协议构建的可进行加密传输，身份认证的网络协议，要比http协议安全。</p> <p>主要区别如下:</p> <p>HTTPS = SSL + HTTP</p> <ul><li>https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用。</li> <li>http是超文本传输协议，信息是明文传输，https是具有安全性的ssl加密传输协议。</li> <li>http和https使用的完全不同的链接方式，用的端口也不一样，前者是80，后者是443。</li> <li>http的连接很简单，是无状态的；HTTPS协议是由SSL+ HTTP协议构建的可进行加密传输，身份认证的网络协议，比如http协议安全。</li></ul> <h2 id="什么是http协议无状态协议-怎么解决http协议无状态协议"><a href="#什么是http协议无状态协议-怎么解决http协议无状态协议" class="header-anchor">#</a> 什么是Http协议无状态协议?怎么解决Http协议无状态协议?</h2> <ul><li>无状态协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息</li> <li>无状态协议解决办法： 通过1、Cookie 2、通过Session会话保存</li></ul> <h2 id="三次握手和四次挥手"><a href="#三次握手和四次挥手" class="header-anchor">#</a> 三次握手和四次挥手</h2> <p><a href="/note/knowledge/tcp.html">三次握手和四次挥手</a></p> <h2 id="为什么连接的时候是三次握手-关闭的时候却是四次握手"><a href="#为什么连接的时候是三次握手-关闭的时候却是四次握手" class="header-anchor">#</a> 为什么连接的时候是三次握手，关闭的时候却是四次握手？</h2> <p>因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，&quot;你发的FIN报文我收到了&quot;。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。</p> <h2 id="为什么time-wait状态需要经过2msl-最大报文段生存时间-才能返回到close状态"><a href="#为什么time-wait状态需要经过2msl-最大报文段生存时间-才能返回到close状态" class="header-anchor">#</a> 为什么TIME_WAIT状态需要经过2MSL(最大报文段生存时间)才能返回到CLOSE状态？</h2> <p>虽然按道理，四个报文都发送完毕，我们可以直接进入CLOSE状态了，但是我们必须假象网络是不可靠的，有可以最后一个ACK丢失。所以TIME_WAIT状态就是用来重发可能丢失的ACK报文。在Client发送出最后的ACK回复，但该ACK可能丢失。Server如果没有收到ACK，将不断重复发送FIN片段。所以Client不能立即关闭，它必须确认Server接收到了该ACK。Client会在发送出ACK之后进入到TIME_WAIT状态。Client会设置一个计时器，等待2MSL的时间。如果在该时间内再次收到FIN，那么Client会重发ACK并再次等待2MSL。所谓的2MSL是两倍的MSL(Maximum Segment Lifetime)。MSL指一个片段在网络中最大的存活时间，2MSL就是一个发送和一个回复所需的最大时间。如果直到2MSL，Client都没有再次收到FIN，那么Client推断ACK已经被成功接收，则结束TCP连接。</p> <h2 id="为什么不能用两次握手进行连接"><a href="#为什么不能用两次握手进行连接" class="header-anchor">#</a> 为什么不能用两次握手进行连接？</h2> <p>3次握手完成两个重要的功能，既要双方做好发送数据的准备工作(双方都知道彼此已准备好)，也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</p> <p>现在把三次握手改成仅需要两次握手，死锁是可能发生的。作为例子，考虑计算机S和C之间的通信，假定C给S发送一个连接请求分组，S收到了这个分组，并发 送了确认应答分组。按照两次握手的协定，S认为连接已经成功地建立了，可以开始发送数据分组。可是，C在S的应答分组在传输中被丢失的情况下，将不知道S 是否已准备好，不知道S建立什么样的序列号，C甚至怀疑S是否收到自己的连接请求分组。在这种情况下，C认为连接还未建立成功，将忽略S发来的任何数据分 组，只等待连接确认应答分组。而S在发出的分组超时后，重复发送同样的分组。这样就形成了死锁。</p> <h2 id="如果已经建立了连接-但是客户端突然出现故障了怎么办"><a href="#如果已经建立了连接-但是客户端突然出现故障了怎么办" class="header-anchor">#</a> 如果已经建立了连接，但是客户端突然出现故障了怎么办？</h2> <p>TCP还设有一个保活计时器，显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。服务器每收到一次客户端的请求后都会重新复位这个计时器，时间通常是设置为2小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个探测报文段，以后每隔75秒钟发送一次。若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">7/28/2023, 7:06:05 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/http/TCP-IP.html" class="prev">
        TCP/IP
      </a></span> <span class="next"><a href="/note/webpacks/webpack.html">
        webpack
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.1b1ef615.js" defer></script><script src="/assets/js/2.b3eacf93.js" defer></script><script src="/assets/js/35.486c6720.js" defer></script>
  </body>
</html>
